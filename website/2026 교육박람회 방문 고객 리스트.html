<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2026 교육 박람회 방문 고객 관리</title>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; font-family:'Pretendard',sans-serif; background:linear-gradient(135deg,#f5f7fa,#e4ebf5); color:#333; }
    .container{max-width:1200px;margin:40px auto;padding:20px}
    h1{text-align:center;margin-bottom:6px}
    .subtitle{text-align:center;color:#666;margin-bottom:30px}
    .top-actions{display:flex;justify-content:center;gap:12px;margin-bottom:30px}
    .btn{padding:8px 16px;border-radius:999px;border:none;cursor:pointer;font-size:13px;font-weight:600}
    .primary{background:#4f7cff;color:#fff}
    .secondary{background:#e9eef6;color:#333}
    .success{background:#16a34a;color:#fff}
    .day-section{background:#fff;border-radius:18px;padding:24px;margin-bottom:30px;box-shadow:0 10px 25px rgba(0,0,0,0.08)}
    .day-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .day-badge{padding:6px 14px;border-radius:999px;font-size:14px;font-weight:600;color:#fff}
    .day1{background:#6c8cff}.day2{background:#5bc8a8}.day3{background:#ff9f6c}
    table{width:100%;border-collapse:collapse;border-radius:12px;overflow:hidden}
    thead{background:#f0f4f8}
    th,td{padding:10px;font-size:14px;text-align:center}
    tr:not(:last-child){border-bottom:1px solid #eee}
    input,textarea,select{width:100%;border:none;background:transparent;font-family:inherit;font-size:14px}
    input:focus,textarea:focus,select:focus{outline:none}
    .status-미연락 (연락X){color:#999}
    .status-메일발송완료{color:#4f7cff;font-weight:600}
    .status-자료요청{color:#ff9f6c;font-weight:600}
    .status-미팅예정{color:#FD51C4;font-weight:600}
    .status-구매완료{color:#5cb8b8;font-weight:600}
  </style>
</head>
<body>
<div class="container">
<h1>2026 교육 박람회 방문 고객 리스트</h1>
<div class="subtitle">행사 기간: 2026.01.21 ~ 01.23</div>

<div class="top-actions">
  <button class="btn secondary" onclick="showAll()">전체 고객 한 화면 보기</button>
  <button class="btn secondary" onclick="hideAll()">날짜별 보기</button>
  <button class="btn success" onclick="exportCSV()">엑셀 / CSV 다운로드</button>
</div>

<script>
// ===== 공통 데이터 =====
const managers = ['담당자','조차장','허차장','이수석','이팀장','원과장','이주임'];

// ===== 저장 / 로드 =====
function saveData(){
  const data = {};
  ['day1','day2','day3'].forEach(day=>{
    data[day] = [];
    document.querySelectorAll(`#${day} tr`).forEach(tr=>{
      const i = tr.querySelectorAll('input, textarea, select');
      data[day].push({
        name: i[0].value,
        org: i[1].value,
        contact: i[2].value,
        meeting: i[3].value,
        status: i[4].value,
        manager: i[5].value
      });
    });
  });
  localStorage.setItem('expoVisitors2026', JSON.stringify(data));
}

function loadData(){
  const d = JSON.parse(localStorage.getItem('expoVisitors2026') || '{}');
  ['day1','day2','day3'].forEach(day=>{
    (d[day] || []).forEach(r=>addRow(day, r));
  });
}

// ===== 행 추가 =====
function addRow(tbodyId, row = {}){
  const tb = document.getElementById(tbodyId);
  const tr = document.createElement('tr');

  tr.innerHTML = `
    <td><input value="${row.name || ''}" oninput="saveData()"></td>
    <td><input value="${row.org || ''}" oninput="saveData()"></td>
    <td><input value="${row.contact || ''}" oninput="saveData()"></td>
    <td><textarea oninput="saveData()">${row.meeting || ''}</textarea></td>
    <td>
      <select onchange="updateStatus(this); saveData()">
        <option ${row.status==='미연락 (연락X)'?'selected':''}>미연락 (연락X)</option>
        <option ${row.status==='메일발송완료'?'selected':''}>메일발송완료</option>
        <option ${row.status==='자료요청'?'selected':''}>자료요청</option>
        <option ${row.status==='미팅예정'?'selected':''}>미팅예정</option>
        <option ${row.status==='구매완료'?'selected':''}>구매완료</option>
      </select>
    </td>
    <td>
      <select onchange="saveData()">
        ${managers.map(m => `<option ${(!row.manager && m==='담당자') || row.manager===m ? 'selected' : ''}>${m}</option>`).join('')}
      </select>
    </td>
    <td><button class="btn secondary" onclick="this.closest('tr').remove(); saveData();">삭제</button></td>
  `;

  tb.appendChild(tr);
  updateStatus(tr.querySelector('td select'));
  saveData();
}

// ===== 상태 색상 =====
function updateStatus(select){
  select.className = 'status-' + select.value;
}

// ===== 전체 보기 =====
function showAll(){
  const tb = document.getElementById('all-table');
  tb.innerHTML = '';
  const d = JSON.parse(localStorage.getItem('expoVisitors2026') || '{}');

  Object.keys(d).forEach(day=>{
    d[day].forEach(r=>{
      tb.innerHTML += `
        <tr>
          <td><b>${day.toUpperCase()}</b></td>
          <td>${r.name||''}</td>
          <td>${r.org||''}</td>
          <td>${r.contact||''}</td>
          <td class="status-${r.status}">${r.status||''}</td>
          <td>${r.manager||''}</td>
          <td>${r.meeting||''}</td>
        </tr>`;
    });
  });
  document.getElementById('days').style.display='none';
  document.getElementById('all-view').style.display='block';
}

function hideAll(){
  document.getElementById('days').style.display='block';
  document.getElementById('all-view').style.display='none';
}

// ===== CSV =====
function exportCSV(){
  const d = JSON.parse(localStorage.getItem('expoVisitors2026') || '{}');
  let csv = '방문일,이름,소속,연락처/E-Mail,후속조치,담당자,미팅내용\n';

  Object.keys(d).forEach(day=>{
    d[day].forEach(r=>{
      csv += `${day.toUpperCase()},"${r.name||''}","${r.org||''}","${r.contact||''}","${r.status||''}","${r.manager||''}","${r.meeting||''}"\n`;
    });
  });

  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = '2026_교육박람회_방문고객리스트.csv';
  a.click();
}

window.onload = loadData;
</script>

<div id="all-view" class="day-section" style="display:none">
<h2 style="margin-bottom:16px">전체 방문 고객 한 눈에 보기</h2>
<table><thead><tr><th>방문일</th><th>이름</th><th>소속</th><th>연락처/E-Mail</th><th>후속조치</th><th>담당자</th><th>미팅 내용</th></tr></thead><tbody id="all-table"></tbody></table>
</div>

<div id="days">
<div class="day-section"><div class="day-header"><h2>방문고객 (1일차)</h2><div><span class="day-badge day1">DAY 1</span><button class="btn primary" onclick="addRow('day1')">+ 추가</button></div></div><table><thead><tr><th>이름</th><th>소속</th><th>연락처/E-Mail</th><th>미팅 내용</th><th>후속조치</th><th>담당자</th><th></th></tr></thead><tbody id="day1"></tbody></table></div>
<div class="day-section"><div class="day-header"><h2>방문고객 (2일차)</h2><div><span class="day-badge day2">DAY 2</span><button class="btn primary" onclick="addRow('day2')">+ 추가</button></div></div><table><thead><tr><th>이름</th><th>소속</th><th>연락처/E-Mail</th><th>미팅 내용</th><th>후속조치</th><th>담당자</th><th></th></tr></thead><tbody id="day2"></tbody></table></div>
<div class="day-section"><div class="day-header"><h2>방문고객 (3일차)</h2><div><span class="day-badge day3">DAY 3</span><button class="btn primary" onclick="addRow('day3')">+ 추가</button></div></div><table><thead><tr><th>이름</th><th>소속</th><th>연락처/E-Mail</th><th>미팅 내용</th><th>후속조치</th><th>담당자</th><th></th></tr></thead><tbody id="day3"></tbody></table></div>
</div>
</div>
</body>
</html>



